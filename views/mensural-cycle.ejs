<!DOCTYPE html>
<html>
<head>
  <title>Menstrual Cycle Tracker</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <h1>Welcome, <%= firstname %></h1>
  <img src="<%= profileImage %>" alt="Profile Image" />

  <form id="tracker-form" action="/menstrualCycle" method="POST">
    <label for="start-date">Start Date:</label>
    <input type="date" id="start-date" name="startDate" required />
    
    <label for="cycle-length">Cycle Length (days):</label>
    <input type="number" id="cycle-length" name="cycleLength" required />
    
    <button type="submit">Log Cycle</button>
  </form>

  <ul id="cycle-list">
    <% cycles.forEach((cycle, index) => { %>
      <li>Cycle <%= index + 1 %>: Start Date - <%= cycle.startDate.toDateString() %>, Cycle Length - <%= cycle.cycleLength %> days</li>
    <% }); %>
  </ul>

  <p id="average-cycle-length">Average Cycle Length: <%= (cycles.reduce((sum, cycle) => sum + cycle.cycleLength, 0) / cycles.length).toFixed(2) %> days</p>
  <p id="next-period-date">Next Expected Period Date: <%= new Date(cycles[cycles.length - 1].startDate).setDate(new Date(cycles[cycles.length - 1].startDate).getDate() + (cycles.reduce((sum, cycle) => sum + cycle.cycleLength, 0) / cycles.length)).toDateString() %></p>

  <script>
    document.getElementById('tracker-form').addEventListener('submit', function(event) {
      const cycleLength = parseInt(document.getElementById('cycle-length').value);
      if (isNaN(cycleLength) || cycleLength <= 0) {
        alert('Please enter a valid cycle length.');
        event.preventDefault();
      }
    });
  </script>
</body>
</html>

